
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pyvesync.github.io/latest/pyvesync3/">
      
      
        <link rel="prev" href="../supported_devices/">
      
      
        <link rel="next" href="../usage/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>pyvesync V3 - pyvesync</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/common.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pyvesync-v30-changes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="pyvesync" class="md-header__button md-logo" aria-label="pyvesync" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M357.7 8.5c-12.3-11.3-31.2-11.3-43.4 0l-208 192c-9.4 8.6-12.7 22-8.5 34 87.1 25.3 155.6 94.2 180.3 181.6L464 416c26.5 0 48-21.5 48-48V256h32c13.2 0 25-8.1 29.8-20.3s1.6-26.2-8.1-35.2zM288 208c0-8.8 7.2-16 16-16h64c8.8 0 16 7.2 16 16v64c0 8.8-7.2 16-16 16h-64c-8.8 0-16-7.2-16-16zM24 256c-13.3 0-24 10.7-24 24s10.7 24 24 24c101.6 0 184 82.4 184 184 0 13.3 10.7 24 24 24s24-10.7 24-24c0-128.1-103.9-232-232-232m8 256a32 32 0 1 0 0-64 32 32 0 1 0 0 64M0 376c0 13.3 10.7 24 24 24 48.6 0 88 39.4 88 88 0 13.3 10.7 24 24 24s24-10.7 24-24c0-75.1-60.9-136-136-136-13.3 0-24 10.7-24 24"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyvesync
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              pyvesync V3
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/webdjoe/pyvesync" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    webdjoe/pyvesync
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="pyvesync" class="md-nav__button md-logo" aria-label="pyvesync" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M357.7 8.5c-12.3-11.3-31.2-11.3-43.4 0l-208 192c-9.4 8.6-12.7 22-8.5 34 87.1 25.3 155.6 94.2 180.3 181.6L464 416c26.5 0 48-21.5 48-48V256h32c13.2 0 25-8.1 29.8-20.3s1.6-26.2-8.1-35.2zM288 208c0-8.8 7.2-16 16-16h64c8.8 0 16 7.2 16 16v64c0 8.8-7.2 16-16 16h-64c-8.8 0-16-7.2-16-16zM24 256c-13.3 0-24 10.7-24 24s10.7 24 24 24c101.6 0 184 82.4 184 184 0 13.3 10.7 24 24 24s24-10.7 24-24c0-128.1-103.9-232-232-232m8 256a32 32 0 1 0 0-64 32 32 0 1 0 0 64M0 376c0 13.3 10.7 24 24 24 48.6 0 88 39.4 88 88 0 13.3 10.7 24 24 24s24-10.7 24-24c0-75.1-60.9-136-136-136-13.3 0-24 10.7-24 24"/></svg>

    </a>
    pyvesync
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/webdjoe/pyvesync" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    webdjoe/pyvesync
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../supported_devices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Devices
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    pyvesync V3
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    pyvesync V3
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#asynchronous-operation" class="md-nav__link">
    <span class="md-ellipsis">
      Asynchronous operation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vesync-class-signature" class="md-nav__link">
    <span class="md-ellipsis">
      VeSync Class Signature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#product-types" class="md-nav__link">
    <span class="md-ellipsis">
      Product Types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-last-response-information" class="md-nav__link">
    <span class="md-ellipsis">
      Device Last Response Information
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Input Validation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strong-typing-with-mashumaro" class="md-nav__link">
    <span class="md-ellipsis">
      Strong Typing with Mashumaro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Strong Typing with Mashumaro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#making-api-calls" class="md-nav__link">
    <span class="md-ellipsis">
      Making API Calls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-container" class="md-nav__link">
    <span class="md-ellipsis">
      Device Container
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-base-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Device Base Classes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-configuration-with-device_map-module" class="md-nav__link">
    <span class="md-ellipsis">
      Device Configuration with device_map module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constants" class="md-nav__link">
    <span class="md-ellipsis">
      Constants
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../development/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/vesync_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VeSync API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/data_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/device_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DeviceMap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/device_container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DeviceContainer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/vesync_device_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VeSyncDevice Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_10" >
        
          
          <label class="md-nav__link" for="__nav_5_10" id="__nav_5_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_10">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/utils/helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Helpers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/utils/colors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Colors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/utils/device_mixins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Device Mixins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/utils/errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Errors & Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/utils/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../devices/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Devices
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Devices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devices/outlets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outlets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devices/switches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Switches
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devices/bulbs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bulbs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devices/air_purifiers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Air Purifiers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devices/humidifiers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Humidifiers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devices/fans/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fans
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devices/kitchen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Air Fryers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devices/thermostats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thermostats
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#asynchronous-operation" class="md-nav__link">
    <span class="md-ellipsis">
      Asynchronous operation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vesync-class-signature" class="md-nav__link">
    <span class="md-ellipsis">
      VeSync Class Signature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#product-types" class="md-nav__link">
    <span class="md-ellipsis">
      Product Types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-last-response-information" class="md-nav__link">
    <span class="md-ellipsis">
      Device Last Response Information
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Input Validation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strong-typing-with-mashumaro" class="md-nav__link">
    <span class="md-ellipsis">
      Strong Typing with Mashumaro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Strong Typing with Mashumaro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#making-api-calls" class="md-nav__link">
    <span class="md-ellipsis">
      Making API Calls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-container" class="md-nav__link">
    <span class="md-ellipsis">
      Device Container
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-base-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Device Base Classes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-configuration-with-device_map-module" class="md-nav__link">
    <span class="md-ellipsis">
      Device Configuration with device_map module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constants" class="md-nav__link">
    <span class="md-ellipsis">
      Constants
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="pyvesync-v30-changes">pyvesync V3.0 Changes<a class="toc-permalink" href="#pyvesync-v30-changes" title="Permanent link">↲</a></h1>
<p><strong>BREAKING CHANGES</strong> - The release of pyvesync 3.0 comes with many improvements and new features, but as a result there are many breaking changes. The structure has been completely refactored, so please read through the documentation and thoroughly test before deploying.</p>
<p>The goal is to standardize the library across all devices to allow easier and consistent maintainability moving forward. The original library was created 8 years ago for supporting only a few outlets, it was not designed for supporting 20+ different devices.</p>
<p>Some of the changes are:</p>
<ul>
<li>Asynchronous network requests with aiohttp</li>
<li>Strong typing of all network requests and responses.</li>
<li>New <code>product_type</code> nomenclature to map with API.</li>
<li>Base classes for all product types for easier <code>isinstance</code> checks.</li>
<li>Standardized the API for all device to follow a common naming convention.</li>
<li>Custom exceptions and error (code) handling for API responses.</li>
<li><code>last_response</code> attribute on device instances to hold information on the last API response.</li>
<li><a class="autorefs autorefs-internal" title="pyvesync.device_container" href="../development/device_container/#pyvesync.device_container"><code>DeviceContainer</code></a> object holds all devices in a mutable set structure with additional convenience methods and properties for managing devices. This is located in the <code>VeSync.manager.devices</code> attribute.</li>
<li>Custom exceptions for better error handling - <a class="autorefs autorefs-internal" title="pyvesync.utils.errors.VeSyncError" href="../development/utils/errors/#pyvesync.utils.errors.VeSyncError"><code>VeSyncError</code></a>, <code>VeSyncAPIException</code>, <code>VeSyncLoginException</code>, <code>VeSyncRateLimitException</code>, <code>VeSyncNoDevicesException</code></li>
<li>Device state has been separated from the device object and is now managed by the device specific subclasses of <a class="autorefs autorefs-internal" title="DeviceState" href="../development/vesync_device_base/#pyvesync.base_devices.vesyncbasedevice.DeviceState"><code>DeviceState</code></a>. The state object is located in the <code>state</code> attribute of the device object.</li>
<li><a class="autorefs autorefs-internal" title="pyvesync.const" href="../development/constants/#pyvesync.const"><code>const</code></a> module to hold all library constants.</li>
<li><a class="autorefs autorefs-internal" title="pyvesync.device_map" href="../development/device_map/#pyvesync.device_map"><code>device_map</code></a> module holds all device type mappings and configuration.</li>
<li>Allow for the changing of regions and API base URL.</li>
</ul>
<p>If you submit a PR please ensure that it follows all conventions outlined in <a href="../development/contributing/">CONTRIBUTING</a>.</p>
<h2 id="asynchronous-operation">Asynchronous operation<a class="toc-permalink" href="#asynchronous-operation" title="Permanent link">↲</a></h2>
<p>Library is now asynchronous, using aiohttp as a replacement for requests. The <code>pyvesync.VeSync</code> class is an asynchronous context manager. A <code>aiohttp.ClientSession</code> can be passed or created internally.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">aiohttp</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pyvesync.vesync</span><span class="w"> </span><span class="kn">import</span> <span class="n">VeSync</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">VeSync</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="n">country_code</span><span class="o">=</span><span class="s2">&quot;US&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">manager</span><span class="p">:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>  <span class="c1"># Still returns true</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">manager</span><span class="o">.</span><span class="n">enabled</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not logged in.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>            <span class="k">return</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_devices</span><span class="p">()</span> <span class="c1"># Instantiates supported devices in device list</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        <span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="n">update</span><span class="p">()</span> <span class="c1"># Updates the state of all devices</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="k">for</span> <span class="n">outlet</span> <span class="ow">in</span> <span class="n">manager</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">outlets</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>            <span class="c1"># The outlet object contain all action methods and static device attributes</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>            <span class="k">await</span> <span class="n">outlet</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>            <span class="k">await</span> <span class="n">outlet</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>            <span class="n">outlet</span><span class="o">.</span><span class="n">display</span><span class="p">()</span> <span class="c1"># Print static device information, name, type, CID, etc.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>            <span class="c1"># State of object held in `device.state` attribute</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">outlet</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>            <span class="n">state_json</span> <span class="o">=</span> <span class="n">outlet</span><span class="o">.</span><span class="n">dumps</span><span class="p">()</span> <span class="c1"># Returns JSON string of device state</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>            <span class="n">state_bytes</span> <span class="o">=</span> <span class="n">orjson</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">outlet</span><span class="o">.</span><span class="n">state</span><span class="p">)</span> <span class="c1"># Returns bytes of device state</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>            <span class="c1"># to view the response information of the last API call</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">outlet</span><span class="o">.</span><span class="n">last_response</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>            <span class="c1"># Prints a ResponseInfo object containing error code,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>            <span class="c1"># and other response information</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="c1"># Or use your own session</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="n">session</span> <span class="o">=</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">VeSync</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>        <span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>        <span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
<p>If using <code>async with</code> is not ideal, the <code>__aenter__()</code> and <code>__aexit__()</code> methods need to be called manually:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">manager</span> <span class="o">=</span> <span class="n">VeSync</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="fm">__aenter__</span><span class="p">()</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">...</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="fm">__aexit__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>
<p>pvesync will close the <code>ClientSession</code> that was created by the library on <code>__aexit__</code>. If a session is passed in as an argument, the library does not close it. If a session is passed in and not closed, aiohttp will generate an error on exit:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>2025-02-16 14:41:07 - ERROR - asyncio - Unclosed client session
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>2025-02-16 14:41:07 - ERROR - asyncio - Unclosed connector
</code></pre></div>
<h2 id="vesync-class-signature">VeSync Class Signature<a class="toc-permalink" href="#vesync-class-signature" title="Permanent link">↲</a></h2>
<p>The VeSync signature is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">VeSync</span><span class="p">(</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">session</span><span class="p">:</span> <span class="n">ClientSession</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">time_zone</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_TZ</span>  <span class="c1"># America/New_York</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="p">)</span>
</code></pre></div>
<p>The VeSync class no longer accepts a <code>debug</code> or <code>redact</code> argument. To set debug the library set <code>manager.debug = True</code> to the instance and <code>manager.redact = True</code>.</p>
<h2 id="product-types">Product Types<a class="toc-permalink" href="#product-types" title="Permanent link">↲</a></h2>
<p>There is a new nomenclature for product types that defines the device class. The
<code>device.product_type</code> attribute defines the product type based on the VeSync API. The product type is used to determine the device class and module. The currently supported product types are:</p>
<ol type="1">
<li><code>outlet</code> - Outlet devices</li>
<li><code>switch</code> - Wall switches</li>
<li><code>fan</code> - Fans (not air purifiers or humidifiers)</li>
<li><code>purifier</code> - Air purifiers (not humidifiers)</li>
<li><code>humidifier</code> - Humidifiers (not air purifiers)</li>
<li><code>bulb</code> - Light bulbs (not dimmers or switches)</li>
<li><code>airfryer</code> - Air fryers</li>
</ol>
<p>See <a href="../supported_devices/">Supported Devices</a> for a complete list of supported devices and models.</p>
<h2 id="custom-exceptions">Custom Exceptions<a class="toc-permalink" href="#custom-exceptions" title="Permanent link">↲</a></h2>
<p>Exceptions are no longer caught by the library and must be handled by the user. Exceptions are raised by server errors and aiohttp connection errors.</p>
<p>Errors that occur at the aiohttp level are raised automatically and propogated to the user. That means exceptions raised by aiohttp that inherit from <code>aiohttp.ClientError</code> are propogated.</p>
<p>When the connection to the VeSync API succeeds but returns an error code that prevents the library from functioning a custom exception inherrited from <code>pyvesync.utils.errors.VeSyncError</code> is raised.</p>
<p>Custom Exceptions raised by all API calls:</p>
<ul>
<li><a class="autorefs autorefs-internal" title="pyvesync.utils.errors.VeSyncServerError" href="../development/utils/errors/#pyvesync.utils.errors.VeSyncServerError">VeSyncServerError</a> - The API connected and returned a code indicated there is a server-side error.</li>
<li><a class="autorefs autorefs-internal" title="pyvesync.utils.errors.VeSyncRateLimitError" href="../development/utils/errors/#pyvesync.utils.errors.VeSyncRateLimitError">VeSyncRateLimitError</a> - The API's rate limit has been exceeded.</li>
<li><a class="autorefs autorefs-internal" title="pyvesync.utils.errors.VeSyncAPIStatusCodeError" href="../development/utils/errors/#pyvesync.utils.errors.VeSyncAPIStatusCodeError">VeSyncAPIStatusCodeError</a> - The API returned a non-200 status code.</li>
<li><a class="autorefs autorefs-internal" title="pyvesync.utils.errors.VeSyncAPIResponseError" href="../development/utils/errors/#pyvesync.utils.errors.VeSyncAPIResponseError">VeSyncAPIResponseError</a> - The response from the API was not in an expected format.</li>
</ul>
<p>Login API Exceptions</p>
<ul>
<li><a class="autorefs autorefs-internal" title="pyvesync.utils.errors.VeSyncLoginError" href="../development/utils/errors/#pyvesync.utils.errors.VeSyncLoginError">VeSyncLoginError</a> - The username or password is incorrect.</li>
</ul>
<p>See <a href="../development/utils/errors/">errors</a> documentation for a complete list of error codes and exceptions.</p>
<h2 id="device-last-response-information">Device Last Response Information<a class="toc-permalink" href="#device-last-response-information" title="Permanent link">↲</a></h2>
<p>If no exception is raised by the API, the response code and message of the last API call is stored in the <code>device.last_response</code> attribute. This is a <a class="autorefs autorefs-internal" title="pyvesync.utils.errors.ResponseInfo


  
      dataclass
  " href="../development/utils/errors/#pyvesync.utils.errors.ResponseInfo"><code>ResponseInfo</code></a> object that contains the following attributes:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">ResponseInfo</span><span class="p">(</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SUCCESS&quot;</span><span class="p">,</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="n">error_type</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">message</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="n">critical_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="n">operational_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="n">device_online</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="p">)</span>
</code></pre></div>
<p>The ResponseInfo object is populated from the API response and source code.</p>
<h2 id="input-validation">Input Validation<a class="toc-permalink" href="#input-validation" title="Permanent link">↲</a></h2>
<p>When values that are required to be in a range are input, such as RGB/HSV colors, fan levels, etc. the library will no longer automatically adjust values outside of that range. The function performing the operation will just return False, with a debug message in the log. This is to minimize complexity and utility of the underlying code. If an invalid input is provided, the library should not assume to correct it.</p>
<p>For example, setting bulb RGB color:</p>
<p><strong>OLD OPERATION</strong> - Entering values outside the accepted range were corrected to the nearest extreme and the operation is performed.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">set_rgb</span> <span class="o">=</span> <span class="k">await</span> <span class="n">bulb</span><span class="o">.</span><span class="n">set_rgb</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">assert</span> <span class="n">set_rgb</span> <span class="o">==</span> <span class="kc">True</span> <span class="c1"># Bulb was set to the min/max RGB 255,0,0</span>
</code></pre></div>
<p><strong>NEW OPERATION</strong> - invalid values return false and operation is not performed.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">set_rgb</span> <span class="o">=</span> <span class="k">await</span> <span class="n">bulb</span><span class="o">.</span><span class="n">set_rgb</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="k">assert</span> <span class="n">set_rgb</span> <span class="o">==</span> <span class="kc">False</span>
</code></pre></div>
<p>All methods that set RGB/HSV color now require all three inputs, red/green/blue or hue/saturation/value. I do not see the use in updating <code>red</code>, <code>green</code> or <code>blue</code>/<code>hue</code>, <code>saturation</code> or <code>value</code> individually. If you have a strong need for this, please open an issue with a detailed use case.</p>
<h2 id="strong-typing-with-mashumaro">Strong Typing with Mashumaro<a class="toc-permalink" href="#strong-typing-with-mashumaro" title="Permanent link">↲</a></h2>
<p>All API requests and responses must be deserialized with a mashumaro dataclass. The dataclass is used to validate the response and ensure that the data is in the expected format. Requests are also serialized with a dataclass model to ensure that there are no breaking changes when changes are made to the library.</p>
<p>The data models are located in the <code>models</code> folder in separate models. The <a class="autorefs autorefs-internal" href="../development/data_models/#pyvesync.models.base_models"><code>base_models</code></a> module contains a dataclass holding the default values that do not change between library changes. The <code>base_models</code> module is imported into all other models to ensure that the default values stay consistent. The <code>base_models</code> module also contains base models that can be inherited for easy configuration and common fields.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nd">@dataclass</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">ResponseBaseModel</span><span class="p">(</span><span class="n">DataClassORJSONMixin</span><span class="p">):</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Base response model for API responses.&quot;&quot;&quot;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Config</span><span class="p">(</span><span class="n">BaseConfig</span><span class="p">):</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;orjson config for dataclasses.&quot;&quot;&quot;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>        <span class="n">orjson_options</span> <span class="o">=</span> <span class="n">orjson</span><span class="o">.</span><span class="n">OPT_NON_STR_KEYS</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>        <span class="n">forbid_extra_keys</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
<p><code>ResponseCodeModel</code> - Inherits from <code>ResponseBaseModel</code> and contains the base keys in most API responses:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nd">@dataclass</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">ResponseCodeModel</span><span class="p">(</span><span class="n">ResponseBaseModel</span><span class="p">):</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Model for the &#39;result&#39; field in response.&quot;&quot;&quot;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="n">traceId</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="n">code</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>
<p>Models for each device should be kept in the <code>data_models</code> folder with the appropriate device name:</p>
<ul>
<li><a class="autorefs autorefs-internal" href="../development/data_models/#pyvesync.models.bypass_models"><code>bypass_models</code></a> - See <a href="../development/"><code>Development</code></a> for more information on bypass devices.</li>
<li><a class="autorefs autorefs-internal" href="../development/data_models/#pyvesync.models.bulb_models"><code>bulb_models</code></a></li>
<li><a class="autorefs autorefs-internal" href="../development/data_models/#pyvesync.models.humidifier_models"><code>humidifier_models</code></a></li>
<li><a class="autorefs autorefs-internal" href="../development/data_models/#pyvesync.models.purifier_models"><code>purifier_models</code></a></li>
<li><a class="autorefs autorefs-internal" href="../development/data_models/#pyvesync.models.outlet_models"><code>outlet_models</code></a></li>
<li><a class="autorefs autorefs-internal" href="../development/data_models/#pyvesync.models.switch_models"><code>switch_models</code></a></li>
<li><a class="autorefs autorefs-internal" href="../development/data_models/#pyvesync.models.fan_models"><code>fan_models</code></a></li>
<li><a class="autorefs autorefs-internal" href="../development/data_models/#pyvesync.models.fryer_models"><code>airfryer_models</code></a></li>
<li><a class="autorefs autorefs-internal" href="../development/data_models/#pyvesync.models.thermostat_models"><code>thermostat_models</code></a></li>
</ul>
<p>There are multiple levels to some requests with nested dictionaries. These must be defined in different classes:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># The ResponseESL100CWDeviceDetail inherits from ResponseCodeModel</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nd">@dataclass</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">ResponseESL100CWDeviceDetail</span><span class="p">(</span><span class="n">ResponseCodeModel</span><span class="p">):</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Response model for Etekcity bulb details.&quot;&quot;&quot;</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>    <span class="n">result</span><span class="p">:</span> <span class="n">ResponseESL100CWDetailResult</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="nd">@dataclass</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">ResponseESL100CWLight</span><span class="p">(</span><span class="n">ResponseBaseModel</span><span class="p">):</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;ESL100CW Tunable Bulb Device Detail Response.&quot;&quot;&quot;</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>    <span class="n">action</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>    <span class="n">brightness</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>    <span class="n">colorTempe</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="nd">@dataclass</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="k">class</span><span class="w"> </span><span class="nc">ResponseESL100CWDetailResult</span><span class="p">(</span><span class="n">ResponseBaseModel</span><span class="p">):</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Result model for ESL100CW Tunable bulb details.&quot;&quot;&quot;</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>    <span class="n">light</span><span class="p">:</span> <span class="n">ResponseESL100CWLight</span>
</code></pre></div>
<p>This model parses the following json response:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pyvesync.data_models.bulb_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResponseESL100CWDeviceDetail</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">orjson</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">api_response</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="s2">&quot;traceId&quot;</span><span class="p">:</span> <span class="s2">&quot;12345678&quot;</span><span class="p">,</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>    <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="s2">&quot;module&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>    <span class="s2">&quot;stacktrace&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>        <span class="s2">&quot;light&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span class="p">,</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>            <span class="s2">&quot;brightness&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>            <span class="s2">&quot;colorTempe&quot;</span><span class="p">:</span> <span class="mi">0</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>        <span class="p">}</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>    <span class="p">}</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="p">}</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="c1"># Response will already be in bytes, so this is unecessary</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="n">response_bytes</span> <span class="o">=</span> <span class="n">orjson</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">api_response</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">orjson</span><span class="o">.</span><span class="n">OPT_NON_STR_KEYS</span><span class="p">)</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="n">response_model</span> <span class="o">=</span> <span class="n">ResponseESL100CWDeviceDetail</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">response_bytes</span><span class="p">)</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="n">result</span> <span class="o">=</span> <span class="n">response_model</span><span class="o">.</span><span class="n">result</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="n">light_model</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">light</span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="nb">print</span><span class="p">(</span><span class="n">light_model</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>  <span class="c1"># prints: on</span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="nb">print</span><span class="p">(</span><span class="n">light_model</span><span class="o">.</span><span class="n">brightness</span><span class="p">)</span>  <span class="c1"># prints: 5</span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="nb">print</span><span class="p">(</span><span class="n">light_model</span><span class="o">.</span><span class="n">colorTempe</span><span class="p">)</span>  <span class="c1"># prints: 0</span>
</code></pre></div>
<h3 id="making-api-calls">Making API Calls<a class="toc-permalink" href="#making-api-calls" title="Permanent link">↲</a></h3>
<p>The helper function <code>pyvesync.utils.helpers.Helpers.get_class_attributes</code> is used to fill the values of the API calls by looking up class attributes, such as <code>token</code> in the <code>VeSync</code> instance and <code>cid</code> in the device instance. It accepts a list of keys and pulls the values of each key as they are found in the passed object:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">,</span> <span class="s1">&#39;accountId&#39;</span><span class="p">,</span> <span class="s1">&#39;cid&#39;</span><span class="p">,</span> <span class="s1">&#39;timeZone&#39;</span><span class="p">,</span> <span class="s1">&#39;countryCode&#39;</span><span class="p">]</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">manager_dict</span> <span class="o">=</span> <span class="n">get_class_attributes</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c1"># request_dict = {&quot;token&quot;: &quot;AUTH_TOKEN&quot;, &quot;accountId&quot;: &quot;ACCOUNT_ID&quot;}</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">device_dict</span> <span class="o">=</span> <span class="n">get_class_attributes</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="c1"># device_dict = {&quot;cid&quot;: &quot;DEVICE CID&quot;}</span>
</code></pre></div>
<p>It can also handle class methods for items such as traceId which need to be calculated each API call:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;traceId&#39;</span><span class="p">]</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">default_dict</span> <span class="o">=</span> <span class="n">get_class_attributes</span><span class="p">(</span><span class="n">DefaultValues</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c1"># {&quot;traceId&quot;: &quot;TIMESTAMP&quot;}</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c1"># It can also handle underscores and different capitalization schemes</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c1"># It will always return the format of the key being passed in:</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;trace_id&quot;</span><span class="p">,</span> <span class="s2">&quot;AccountID&quot;</span><span class="p">]</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="n">request_dict</span> <span class="o">=</span> <span class="n">get_class_attributes</span><span class="p">(</span><span class="n">DefaultValues</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="c1"># {&quot;trace_id&quot;: &quot;TIMESTAMP&quot;}</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="n">manager_dict</span> <span class="o">=</span> <span class="n">get_class_attributes</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="c1"># {&quot;AccountID&quot;: &quot;ACCOUNT ID&quot;}</span>
</code></pre></div>
<h2 id="device-container">Device Container<a class="toc-permalink" href="#device-container" title="Permanent link">↲</a></h2>
<p>Devices are held in the <a class="autorefs autorefs-internal" title="pyvesync.device_container.DeviceContainer" href="../development/device_container/#pyvesync.device_container.DeviceContainer">DeviceContainer</a> class in the <code>manager.devices</code> attribute. The <code>DeviceContainer</code> class is a singleton class, so only one instance can exist. The class inherits from <code>MutableSet</code> so it contains unique objects, with the ability to add and remove devices using the <code>add</code>, <code>remove</code> and <code>clear</code> methods. However, these methods only accept device objects. To simplify removing devices, there is the <code>remove_by_cid(cid: str)</code> method.</p>
<p>To get devices by device name, use the <code>get_by_name(name: str)</code> method. There are two convenience methods <code>add_new_devices</code> and <code>remove_stale_devices</code> that accept the device list response model.</p>
<p>The <code>DeviceContainer</code> object has a property for each product type that returns a list of devices. For example, <code>DeviceContainer.outlets</code> returns a list of all outlets product type devices.</p>
<p>See <a href="../development/device_container/">DeviceContainer</a> for more information on the device container.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pyvesync</span><span class="w"> </span><span class="kn">import</span> <span class="n">VeSync</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">VeSync</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="k">as</span> <span class="n">manager</span><span class="p">:</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">manager</span><span class="o">.</span><span class="n">devices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="c1"># No devices yet</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>        <span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>        <span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_devices</span><span class="p">()</span> <span class="c1"># Pulls in devices</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">manager</span><span class="o">.</span><span class="n">devices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="c1"># Devices are now in the container</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">manager</span><span class="o">.</span><span class="n">devices</span><span class="p">:</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="c1"># Prints all devices in the container</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>        <span class="n">manager</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Pull state into devices</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>        <span class="c1"># also holds the product types as properties</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>        <span class="n">outlets</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">outlets</span>  <span class="c1"># list of VeSyncOutlet objects</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>        <span class="n">switches</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">switches</span> <span class="c1"># list of VeSyncSwitch objects</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a>        <span class="n">fans</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">fans</span>  <span class="c1"># list of VeSyncFan objects</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a>        <span class="n">bulbs</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">bulbs</span>  <span class="c1"># list of VeSyncBulb objects</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>        <span class="n">humidifiers</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">humidifiers</span> <span class="c1"># VeSyncHumid objects</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>        <span class="n">air_purifiers</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">air_purifiers</span> <span class="c1"># list of VeSyncPurifier objects</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
<h2 id="device-base-classes">Device Base Classes<a class="toc-permalink" href="#device-base-classes" title="Permanent link">↲</a></h2>
<p>The device classes are now all inherited from their own product type specific base class. All base classes still inherit from <a class="autorefs autorefs-internal" title="VeSyncBaseDevice" href="../development/vesync_device_base/#pyvesync.base_devices.vesyncbasedevice.VeSyncBaseDevice"><code>vesyncbasedevice</code></a>. The base class provides the common functionality for all devices and the device classes provide the specific functionality for each device. The <code>pyvesync.base_devices</code> module contains the base classes for all devices in their respective modules by product type. The base state class is <a class="autorefs autorefs-internal" title="DeviceState" href="../development/vesync_device_base/#pyvesync.base_devices.vesyncbasedevice.DeviceState"><code>DeviceState</code></a>. Both <code>VeSyncBaseDevice</code> and <code>DeviceState</code> are inherited by device and their state classes.</p>
<p>The base module should hold all properties and methods that are common to all devices. The base module also contains the base devices state class. The base device state class holds all state attributes for all underlying devices.</p>
<h2 id="device-configuration-with-device_map-module">Device Configuration with device_map module<a class="toc-permalink" href="#device-configuration-with-device_map-module" title="Permanent link">↲</a></h2>
<p>All features and configuration options for devices are held in the <code>pyveysnc.device_map</code> module. Older versions of pyvesync held the device configuration in each device module, all of these have moved to the <code>device_map</code> module. Each product type has a dataclass structure that is used to define all of the configuration options for each type. The <code>device_map.get_device_config(device_type: str)</code> method is used to lookup the configuration dataclass instance by the <code>deviceType</code> value in the device list response.</p>
<h2 id="constants">Constants<a class="toc-permalink" href="#constants" title="Permanent link">↲</a></h2>
<p>All constants should be located in the <a class="autorefs autorefs-internal" title="pyvesync.const" href="../development/constants/#pyvesync.const">const</a> module, including default values. There should not be any constants defined in the code. Use <code>enum.StrEnum</code> or <code>enum.IntEnum</code> for Enum values.</p>
<p>All device modes and feature names are defined in this module.</p>
<p><code>IntEnum</code> and <code>StrEnum</code> are preferred for device status and state because boolean only allows for two states. There is no way to tell if the state is not yet known or unsupported.</p>
<p>The <code>IntFlag</code> and <code>StrFlag</code> classes are used to define attributes in the state class that may not be supported by all devices.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">IntFlag</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Integer flag to indicate if a device is not supported.</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="sd">    This is used by data models as a default value for feature attributes</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="sd">    that are not supported by all devices.</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="sd">    The default value is -999.</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>    <span class="n">NOT_SUPPORTED</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return string representation of IntFlag.&quot;&quot;&quot;</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="k">class</span><span class="w"> </span><span class="nc">StrFlag</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;String flag to indicate if a device is not supported.</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="sd">    This is used by data models as a default value for feature attributes</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="sd">    that are not supported by all devices.</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="sd">    The default value is &quot;not_supported&quot;.</span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>    <span class="n">NOT_SUPPORTED</span> <span class="o">=</span> <span class="s2">&quot;not_supported&quot;</span>
</code></pre></div>
<p>The string states that support 'on' and 'off' have helper methods that allow for
easy conversion from bool and int values:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pyvesync.const</span><span class="w"> </span><span class="kn">import</span> <span class="n">DeviceStatus</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">api_int</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="n">api_bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="n">device</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">device_status</span> <span class="o">=</span> <span class="n">DeviceStatus</span><span class="o">.</span><span class="n">from_int</span><span class="p">(</span><span class="n">api_int</span><span class="p">)</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="k">assert</span> <span class="n">device</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">device_status</span> <span class="o">==</span> <span class="n">DeviceStatus</span><span class="o">.</span><span class="n">ON</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="n">device</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">device_status</span> <span class="o">=</span> <span class="n">DeviceStatus</span><span class="o">.</span><span class="n">from_bool</span><span class="p">(</span><span class="n">api_bool</span><span class="p">)</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="k">assert</span> <span class="n">device</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">device_status</span> <span class="o">==</span> <span class="n">DeviceStatus</span><span class="o">.</span><span class="n">ON</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="n">api_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">device_status</span><span class="p">)</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="k">assert</span> <span class="n">api_int</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="n">api_bool</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">device_status</span><span class="p">)</span>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="k">assert</span> <span class="n">api_bool</span> <span class="o">==</span> <span class="kc">True</span>
</code></pre></div>
<p><strong>Note that this only works for on/off values.</strong></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["search.suggest", "navigation.indexes", "search.highlight", "toc.follow", "navigation.top"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>